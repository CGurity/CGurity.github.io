<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes So far, we covered an\u00a0introduction\u00a0to threat modeling, the use of virtual machines as environments to analyze malware, and how to start analyzing\u00a0PDFs\u00a0and\u00a0Microsoft Office\u00a0documents in previous parts. All these topics will help us to give better support to others as the first line of defense against suspicious documents.">
<title>Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure</title>

<link rel='canonical' href='http://localhost:1313/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/'>

<link rel="stylesheet" href="/scss/style.min.b28523dc9ab58fa061e5c1d3fc4cf0b596658650e50850a9e38bb46d54fd77ef.css"><meta property='og:title' content="Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure">
<meta property='og:description' content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes So far, we covered an\u00a0introduction\u00a0to threat modeling, the use of virtual machines as environments to analyze malware, and how to start analyzing\u00a0PDFs\u00a0and\u00a0Microsoft Office\u00a0documents in previous parts. All these topics will help us to give better support to others as the first line of defense against suspicious documents.">
<meta property='og:url' content='http://localhost:1313/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/'>
<meta property='og:site_name' content='Carlos Guerra'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='maldocs-series' /><meta property='article:published_time' content='2023-01-04T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-01-04T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1.jpg' />
<meta name="twitter:title" content="Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure">
<meta name="twitter:description" content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes So far, we covered an\u00a0introduction\u00a0to threat modeling, the use of virtual machines as environments to analyze malware, and how to start analyzing\u00a0PDFs\u00a0and\u00a0Microsoft Office\u00a0documents in previous parts. All these topics will help us to give better support to others as the first line of defense against suspicious documents."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1.jpg' />
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu99184f921ef7b179b9ae7ead5236baa2_57844_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Carlos Guerra</a></h1>
            <h2 class="site-description">Digital security trainer, auditor, and advisor</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://bsky.app/profile/cguerra.bsky.social'
                        target="_blank"
                        title="Bluesky"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bluesky"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.335 5.144c-1.654 -1.199 -4.335 -2.127 -4.335 .826c0 .59 .35 4.953 .556 5.661c.713 2.463 3.13 2.75 5.444 2.369c-4.045 .665 -4.889 3.208 -2.667 5.41c1.03 1.018 1.913 1.59 2.667 1.59c2 0 3.134 -2.769 3.5 -3.5c.333 -.667 .5 -1.167 .5 -1.5c0 .333 .167 .833 .5 1.5c.366 .731 1.5 3.5 3.5 3.5c.754 0 1.637 -.571 2.667 -1.59c2.222 -2.203 1.378 -4.746 -2.667 -5.41c2.314 .38 4.73 .094 5.444 -2.369c.206 -.708 .556 -5.072 .556 -5.661c0 -2.953 -2.68 -2.025 -4.335 -.826c-2.293 1.662 -4.76 5.048 -5.665 6.856c-.905 -1.808 -3.372 -5.194 -5.665 -6.856z" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/CGurity'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://mastodon.social/@CGurity'
                        target="_blank"
                        title="Mastodon"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z" /><path d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722" /></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#in-general">In general</a>
      <ol>
        <li><a href="#antivirus-solutions">Antivirus solutions</a></li>
        <li><a href="#keep-software-legal-and-updated">Keep software legal and updated</a></li>
        <li><a href="#review-the-file-extension-of-suspicious-files">Review the file extension of suspicious files</a></li>
        <li><a href="#use-borrowed-readers">Use &ldquo;borrowed&rdquo; readers</a></li>
        <li><a href="#use-specific-tools-designed-for-this-use-case">Use specific tools designed for this use case</a></li>
        <li><a href="#checking-file-hashes-in-detection-platforms">Checking file hashes in detection platforms</a></li>
      </ol>
    </li>
    <li><a href="#specific-to-pdfs-disable-javascript-execution-in-reader-and-other-security-settings">Specific to PDFs: Disable Javascript execution in reader (and other security settings)</a></li>
    <li><a href="#specific-to-office">Specific to office</a>
      <ol>
        <li><a href="#minimize-the-use-of-macros-in-legitimate-activities">Minimize the use of macros in legitimate activities</a></li>
        <li><a href="#disable-macros-and-check-the-trust-center">Disable macros and check the Trust Center</a></li>
      </ol>
    </li>
    <li><a href="#whats-next">What&rsquo;s next</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/">
                <img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_800x0_resize_q75_box.jpg"
                        srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_800x0_resize_q75_box.jpg 800w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="460" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/guide/" style="background-color: #00798C; color: #fff;">
                Guide
            </a>
        
            <a href="/categories/author/" style="background-color: #D1495B; color: #fff;">
                Author
            </a>
        
            <a href="/categories/en/" style="background-color: #30638E; color: #fff;">
                EN
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/">Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 04, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    9 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>This series was posted originally in the <a class="link" href="https://greaterinternetfreedom.org/course/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/"  target="_blank" rel="noopener"
    >Greater Internet Freedom program website</a>, this is a copy for archiving purposes</p>
</blockquote>
<p>So far, we covered an <a class="link" href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/" >introduction </a>to threat modeling, the use of virtual machines as environments to analyze malware, and how to start analyzing <a class="link" href="/p/analysis-of-malicious-documents-part-02-pdf-documents/" >PDFs </a>and <a class="link" href="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/" >Microsoft Office</a> documents in previous parts. All these topics will help us to give better support to others as the first line of defense against suspicious documents.</p>
<p>Still, if we support vulnerable actors (the primary intended audience of this series of posts), we know that this is only half of the story. We also need to ensure we can provide good proactive advice to our beneficiaries, so they are well protected from malicious documents before they arrive at their hard drives. Hopefully, with all the content we reviewed, we can not only understand better the classic advice we give to end-users but also propose a couple of additional measures that could be useful for vulnerable actors with an increased risk level.</p>
<p>The first idea we want to reinforce is that telling activists, journalists, and media that they shouldn&rsquo;t open files from unknown sources is not sustainable advice. To carry on their activities, many people in these categories need to open files sent to them that might contain threats, like press conference invitations, leaked documents, event agendas, etc. So, the most pertinent advice we can give them is to know the risks and to build processes to let them open the files in the safest way possible.</p>
<p>That said, some defensive measures against malicious documents include</p>
<h2 id="in-general">In general
</h2><h3 id="antivirus-solutions">Antivirus solutions
</h3><p>Many malicious documents distributed are part of massive operations that are successfully documented and integrated into antivirus detection databases. Keep in mind that this recommendation doesn&rsquo;t guarantee the detection of malicious files that are tailor-made for specific targets. Still, it will give a layer of security that is worth having, especially if operating with many untrusted files. Remember to choose a reputable vendor, activate real-time detection if available, and keep the database updated.</p>
<h3 id="keep-software-legal-and-updated">Keep software legal and updated
</h3><p>Every year there are hundreds of new vulnerabilities are discovered and disclosed for many everyday used programs, including Microsoft Office and PDF readers, and said vulnerabilities are &ldquo;patched&rdquo; through software updates. So, having all the software up to date will reduce drastically the chances of someone using well-known and documented vulnerabilities to attack a target and succeeding. Having pirated software will affect its ability to detect and apply software updates, making it a security problem. This is why having original software is advisable from a security perspective, even before addressing legal considerations.</p>
<h3 id="review-the-file-extension-of-suspicious-files">Review the file extension of suspicious files
</h3><p>Some campaigns trick users into opening harmful files disguised as documents but are other kinds of files, like executable applications, .zip files, or other container file types such as .iso, etc. Usually, these files even include custom icons to look like MS Word documents, PDFs, etc. Checking carefully the files we download and open will give us another layer of protection by catching when a file doesn&rsquo;t have a common or expected file type.</p>
<h3 id="use-borrowed-readers">Use &ldquo;borrowed&rdquo; readers
</h3><p>A common strategy is to open suspicious documents in an environment away from your computer that is better equipped to detect and contain any potential threat. A classic example is to open files using Google Drive (this includes previews in Gmail); then,  the file is actually opened in Google&rsquo;s servers and rendered to our computers, making Google (or any other platform with similar capabilities) the actor that has to worry of specific threats contained in opened documents. A downside of this approach is that we lose some visibility and analysis capacity, given that we are not downloading the files, but it will be helpful for everyday use.</p>
<h3 id="use-specific-tools-designed-for-this-use-case">Use specific tools designed for this use case
</h3><p>There are tools that take the same principle of using a safe environment to open files but streamline the process for the user and then generate safe copies that only contain the visible elements (similar to printing the document and scanning the result into a final file). One of the tools is <a class="link" href="https://dangerzone.rocks/"  target="_blank" rel="noopener"
    >Dangerzone</a>, a program that receives a suspicious file and generates a copy that is safe to open. The only notable downside is that the tool requires downloading dependencies of some Gbs of size, so if hard disk space and/or download speeds and stability are an issue, this tool can be more difficult to set up. Another tool for achieving this goal is Circ.lu&rsquo;s <a class="link" href="https://www.circl.lu/projects/CIRCLean/"  target="_blank" rel="noopener"
    >CIRCLean USB sanitizer,</a> which uses a separate computer (they propose a <a class="link" href="https://www.raspberrypi.com/"  target="_blank" rel="noopener"
    >Raspberry Pi</a>) and two USB drives. In the first drive, you save the suspicious versions of the files, and the software will generate the safe copies and save them on the second USB drive. The most notable challenges with this approach are using dedicated hardware to operate the files and adding extra physical steps to move files to and from USB drives.</p>
<h3 id="checking-file-hashes-in-detection-platforms">Checking file hashes in detection platforms
</h3><p>Another common strategy when in front of suspicious files, is checking in platforms like <a class="link" href="https://www.virustotal.com/gui/home/search"  target="_blank" rel="noopener"
    >VirusTotal</a> if the file is known as malicious. This will help us save time in case the file is a known threat and will even give us more valuable information, like what kind of malware it tries to execute and messages from community members associated with the file. A very important observation is to know that uploading the file to tools like VirusTotal will put the file at the community disposition, disclosing the content of the document (that might have sensitive information), and potentially alerting the document creators if they are monitoring the specific file. A workaround for this is to not upload the file but checking it&rsquo;s hash instead. In the <a class="link" href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/" >first part of this series</a>, there is guidance on how to check hashes.</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1.jpg"
	width="768"
	height="442"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>Example of searching for the hash of one file, August 2022</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/2.jpg"
	width="768"
	height="442"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/2_hud5c69fdd17ddd8534b613618f45e0ec7_44887_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/2_hud5c69fdd17ddd8534b613618f45e0ec7_44887_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>Example of results in VirusTotal, August 2022</p>
<h2 id="specific-to-pdfs-disable-javascript-execution-in-reader-and-other-security-settings">Specific to PDFs: Disable Javascript execution in reader (and other security settings)
</h2><p>Depending on your PDF reader software, the execution of JavaScript code might be already disabled, however, it is advisable to double-check in case you expect to open suspicious files. Also, depending on your reader, there might be other security features that can be configured.</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/3.jpg"
	width="768"
	height="491"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/3_hu659c1d86db0fb1d74ef014d2d5fbbc4d_46681_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/3_hu659c1d86db0fb1d74ef014d2d5fbbc4d_46681_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="375px"
	
></p>
<p>Example for Acrobat Reader (August 2022, Menu Edit -&gt; Preferences -&gt; Javascript)</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/4.jpg"
	width="770"
	height="508"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/4_hu2b4f95c981f68843e22090e8d38fa56e_79304_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/4_hu2b4f95c981f68843e22090e8d38fa56e_79304_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="151"
		data-flex-basis="363px"
	
></p>
<p>Example for Foxit Reader (August 2022, Menu File-&gt;Preferences-&gt;Javascript)</p>
<h2 id="specific-to-office">Specific to office
</h2><h3 id="minimize-the-use-of-macros-in-legitimate-activities">Minimize the use of macros in legitimate activities
</h3><p>Even when there are many acceptable and harmless use cases for macros, using documents with them frequently and being used to allow them, might open the door to receiving a malicious document and enabling its macros accidentally, especially organizations should be mindful of this situation and plan accordingly or removing the use of macros, or preparing processes to live with them, considering how to handle untrusted files.</p>
<h3 id="disable-macros-and-check-the-trust-center">Disable macros and check the Trust Center
</h3><p>Microsoft Office recently changed its policy regarding macros multiple times, so depending on when you are reading this material, Office might have macros enabled or disabled by default; also, there might be rules depending on the origin of files, etc. One way of having more visibility and control is checking the Trust Center to see and configure directly the behavior towards macros.</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/5.jpg"
	width="826"
	height="678"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/5_hu91cb41242df80541a33b342d7fa429a0_88883_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/5_hu91cb41242df80541a33b342d7fa429a0_88883_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="121"
		data-flex-basis="292px"
	
></p>
<p>Trust Center for MS Office (August 2022, Menu File-&gt;Options-&gt;Trust Center-&gt;Trust Center Settings-&gt;Macro Settings)</p>
<p>Another interesting feature in MS Office is Protected View, which considering the origin of a file, opens it in a sandboxed environment with little privilege or access to interfere with the computer, offering another layer of trust. One problem with this mode is that, similar to macro blocking; there is a button in a ribbon above the document where the user can disable the Protected View feature, again enabling attacks where the document creator tricks the user to disable this protection.</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/6.jpg"
	width="826"
	height="678"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/6_hu91cb41242df80541a33b342d7fa429a0_91782_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/6_hu91cb41242df80541a33b342d7fa429a0_91782_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="121"
		data-flex-basis="292px"
	
></p>
<p>Protected View settings (August 2022, Menu File-&gt;Options-&gt;Trust Center-&gt;Trust Center Settings-&gt;Protected View)</p>
<p><img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/7.jpg"
	width="768"
	height="444"
	srcset="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/7_hu72ae350c911e9e9a897fb33a717afe42_40943_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/7_hu72ae350c911e9e9a897fb33a717afe42_40943_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="415px"
	
></p>
<p>Protected View for a MS Word document (August 2022)</p>
<h2 id="whats-next">What&rsquo;s next
</h2><p>First, when receiving a suspicious file, you will have the skills to run a first analysis to see any obvious security problems; the potential scenarios might be abstracted to these:</p>
<ol>
<li>If the file doesn&rsquo;t seem to contain anything harmful, we can lower the suspicion level of the file.
<ul>
<li>If, by any chance, the target has a high-risk level, we might want to double-check with other colleagues or more specialized groups.</li>
</ul>
</li>
<li>If the file seems malicious, we might try to search on platforms like VirusTotal for its hash, and if it is a known malware sample, we will find a lot of more detailed information that will be useful for understanding the nature of the threat, how massive is the campaign, etc.</li>
<li>If the threats contained in the file are easy to detect and understand, but not known by the community, we should be able to give some insight on the specifics when researching more or looking for help.</li>
<li>If the elements contained in the file seem advanced, hard to understand, or even difficult to categorize as threats; and the file hash is unknown to public platforms, it is worth reaching out to more specialized organizations that can take a better look into the files in search of not-so-obvious threats.</li>
</ol>
<p>Also, we advise in general to:</p>
<ul>
<li>Avoid executing any suspicious code (unless you understand the risks and take the respective precautions, which are not covered in this material)</li>
<li>Research more on any specific things you find and you don&rsquo;t know about. There are a lot of different commands and ways to achieve things with code, and it is unsustainable to know all of them, so it is normal and expected to review documentation looking for specific instructions or features to understand better the functionality of a macro or other unknown objects.</li>
</ul>
<p>Keep in mind that analyzing malicious documents (and malware in general) is a full career that usually requires years of experience to handle more advanced cases. That said, we reinforce that this material is an introduction to a specific portion of malware analysis that hopefully will encourage the reader to learn more and gain more skills in this field. However, given the risk associated to operate malicious artifacts without proper processes and security considerations, we discourage the readers to add more processes and analysis tools to the presented workflows without proper knowledge of those processes and tools, especially those involving the execution of malware (or dynamic analysis).</p>
<hr>
<p>This is a material in constant revision. For any questions or feedback, please reach out to me :)</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/maldocs-series/">Maldocs-Series</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/11.c0e4f96763858472ba13168bd8c9d580_hu26eed9cc7c1228930433ac93552fb2d8_79691_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 03 – Microsoft Office documents"
                        
                        data-hash="md5-wOT5Z2OFhHK6ExaL2MnVgA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 03 – Microsoft Office documents</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-02-pdf-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/13.9fc6d1d131919eee16849d6694281c26_hu240fb05a8481aa980793c3ec9617edae_85474_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 02 – PDF documents"
                        
                        data-hash="md5-n8bR0TGRnu4WhJ1mlCgcJg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 02 – PDF documents</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/6.b50246bde9b1d2f15ed77edc7999985e_hu71091bd9fd3cc51e63e3804503417e43_60794_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 01 – Introduction and VMs"
                        
                        data-hash="md5-tQJGvemx0vFe137ceZmYXg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 01 – Introduction and VMs</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/sda-safe-and-documented-for-activism-sda-seguros-y-documentados-para-el-activismo/">
        
        
            <div class="article-image">
                <img src="/p/sda-safe-and-documented-for-activism-sda-seguros-y-documentados-para-el-activismo/sda.20fce1dedb42d131e7757f05163f36ec_hu5a8ad7f9d9c6297e9afdcb725f5bca37_30238_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post SDA: Safe and documented for activism | SDA: Seguros y documentados para el activismo"
                        
                        data-hash="md5-IPzh3ttC0THndX8FFj827A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SDA: Safe and documented for activism | SDA: Seguros y documentados para el activismo</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1.b4a1092850d9c8a78babc75343a6b125_hu36a617cf5e3c297ddbde091be7327273_36258_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  "
                        
                        data-hash="md5-tKEJKFDZyKeLq8dTQ6axJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  </h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Carlos Guerra
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
