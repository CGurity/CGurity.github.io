<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes After the overview of virtual machine management and installation of Remnux as an environment to analyze suspicious artifacts, we will explore PDF files in terms of format and ways they can be used to harm users. What is a PDF? When we open a PDF file, we use specific software that render its content in a readable way, however, as many other file types, PDFs are built using a combination of regular plain text and binary data (for images and other elements that might require it), for instance, the following text renders the PDF file showed after:">
<title>Analysis of malicious documents – Part 02 – PDF documents</title>

<link rel='canonical' href='http://localhost:1313/p/analysis-of-malicious-documents-part-02-pdf-documents/'>

<link rel="stylesheet" href="/scss/style.min.b28523dc9ab58fa061e5c1d3fc4cf0b596658650e50850a9e38bb46d54fd77ef.css"><meta property='og:title' content="Analysis of malicious documents – Part 02 – PDF documents">
<meta property='og:description' content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes After the overview of virtual machine management and installation of Remnux as an environment to analyze suspicious artifacts, we will explore PDF files in terms of format and ways they can be used to harm users. What is a PDF? When we open a PDF file, we use specific software that render its content in a readable way, however, as many other file types, PDFs are built using a combination of regular plain text and binary data (for images and other elements that might require it), for instance, the following text renders the PDF file showed after:">
<meta property='og:url' content='http://localhost:1313/p/analysis-of-malicious-documents-part-02-pdf-documents/'>
<meta property='og:site_name' content='Carlos Guerra'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='maldocs-series' /><meta property='article:published_time' content='2023-01-02T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-01-02T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/p/analysis-of-malicious-documents-part-02-pdf-documents/13.png' />
<meta name="twitter:title" content="Analysis of malicious documents – Part 02 – PDF documents">
<meta name="twitter:description" content="This series was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes After the overview of virtual machine management and installation of Remnux as an environment to analyze suspicious artifacts, we will explore PDF files in terms of format and ways they can be used to harm users. What is a PDF? When we open a PDF file, we use specific software that render its content in a readable way, however, as many other file types, PDFs are built using a combination of regular plain text and binary data (for images and other elements that might require it), for instance, the following text renders the PDF file showed after:"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/analysis-of-malicious-documents-part-02-pdf-documents/13.png' />
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu99184f921ef7b179b9ae7ead5236baa2_57844_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Carlos Guerra</a></h1>
            <h2 class="site-description">Digital security trainer, auditor, and advisor</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://bsky.app/profile/cguerra.bsky.social'
                        target="_blank"
                        title="Bluesky"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bluesky"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.335 5.144c-1.654 -1.199 -4.335 -2.127 -4.335 .826c0 .59 .35 4.953 .556 5.661c.713 2.463 3.13 2.75 5.444 2.369c-4.045 .665 -4.889 3.208 -2.667 5.41c1.03 1.018 1.913 1.59 2.667 1.59c2 0 3.134 -2.769 3.5 -3.5c.333 -.667 .5 -1.167 .5 -1.5c0 .333 .167 .833 .5 1.5c.366 .731 1.5 3.5 3.5 3.5c.754 0 1.637 -.571 2.667 -1.59c2.222 -2.203 1.378 -4.746 -2.667 -5.41c2.314 .38 4.73 .094 5.444 -2.369c.206 -.708 .556 -5.072 .556 -5.661c0 -2.953 -2.68 -2.025 -4.335 -.826c-2.293 1.662 -4.76 5.048 -5.665 6.856c-.905 -1.808 -3.372 -5.194 -5.665 -6.856z" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/CGurity'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://mastodon.social/@CGurity'
                        target="_blank"
                        title="Mastodon"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z" /><path d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722" /></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#what-is-a-pdf">What is a PDF?</a>
      <ol>
        <li><a href="#file-structure">File structure</a></li>
        <li><a href="#understanding-pdf-objects">Understanding PDF objects</a></li>
      </ol>
    </li>
    <li><a href="#enter-pdfid">Enter pdfid</a></li>
    <li><a href="#enter-pdf-parser-example-1">Enter pdf-parser, example 1</a></li>
    <li><a href="#example-2">Example 2</a></li>
    <li><a href="#example-3">Example 3</a></li>
    <li><a href="#challenges">Challenges</a></li>
    <li><a href="#whats-next">What&rsquo;s next</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/analysis-of-malicious-documents-part-02-pdf-documents/">
                <img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/13_hu240fb05a8481aa980793c3ec9617edae_85474_800x0_resize_box_3.png"
                        srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/13_hu240fb05a8481aa980793c3ec9617edae_85474_800x0_resize_box_3.png 800w, /p/analysis-of-malicious-documents-part-02-pdf-documents/13_hu240fb05a8481aa980793c3ec9617edae_85474_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="389" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 02 – PDF documents" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/guide/" style="background-color: #00798C; color: #fff;">
                Guide
            </a>
        
            <a href="/categories/author/" style="background-color: #D1495B; color: #fff;">
                Author
            </a>
        
            <a href="/categories/en/" style="background-color: #30638E; color: #fff;">
                EN
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/analysis-of-malicious-documents-part-02-pdf-documents/">Analysis of malicious documents – Part 02 – PDF documents</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 02, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    12 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>This series was posted originally in the <a class="link" href="https://greaterinternetfreedom.org/course/analysis-of-malicious-documents-part-02-pdf-documents/"  target="_blank" rel="noopener"
    >Greater Internet Freedom program website</a>, this is a copy for archiving purposes</p>
</blockquote>
<p>After the overview of <a class="link" href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/" >virtual machine management and installation of Remnux as an environment to analyze suspicious artifacts</a>, we will explore PDF files in terms of format and ways they can be used to harm users.</p>
<h2 id="what-is-a-pdf">What is a PDF?
</h2><p>When we open a PDF file, we use specific software that render its content in a readable way, however, as many other file types, PDFs are built using a combination of regular plain text and binary data (for images and other elements that might require it), for instance, the following text renders the PDF file showed after:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">%PDF-1.4
</span></span><span class="line"><span class="cl">1 0 obj
</span></span><span class="line"><span class="cl">&lt;&lt;
</span></span><span class="line"><span class="cl">	/Length 51
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">stream
</span></span><span class="line"><span class="cl">1 0 0 RG
</span></span><span class="line"><span class="cl">5 w
</span></span><span class="line"><span class="cl">36 144 m
</span></span><span class="line"><span class="cl">180 144 l
</span></span><span class="line"><span class="cl">180 36 l
</span></span><span class="line"><span class="cl">36 36 l
</span></span><span class="line"><span class="cl">s
</span></span><span class="line"><span class="cl">endstream
</span></span><span class="line"><span class="cl">endobj
</span></span><span class="line"><span class="cl">2 0 obj
</span></span><span class="line"><span class="cl">&lt;&lt;
</span></span><span class="line"><span class="cl">	/Type /Catalog
</span></span><span class="line"><span class="cl">	/Pages 3 0 R
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">endobj
</span></span><span class="line"><span class="cl">3 0 obj
</span></span><span class="line"><span class="cl">&lt;&lt;
</span></span><span class="line"><span class="cl">	/Type /Pages
</span></span><span class="line"><span class="cl">	/Kids [4 0 R ]
</span></span><span class="line"><span class="cl">	/Count 1
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">endobj
</span></span><span class="line"><span class="cl">4 0 obj
</span></span><span class="line"><span class="cl">&lt;&lt; 
</span></span><span class="line"><span class="cl">	/Type /Page
</span></span><span class="line"><span class="cl">	/Parent 3 0 R
</span></span><span class="line"><span class="cl">	/MediaBox [0 0 612 792] 
</span></span><span class="line"><span class="cl">	/Contents 1 0 R
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">endobj
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">xref
</span></span><span class="line"><span class="cl">0 4
</span></span><span class="line"><span class="cl">0000000000 65535 f
</span></span><span class="line"><span class="cl">0000000010 00000 n
</span></span><span class="line"><span class="cl">0000000113 00000 n
</span></span><span class="line"><span class="cl">0000000165 00000 n
</span></span><span class="line"><span class="cl">0000000227 00000 n
</span></span><span class="line"><span class="cl">trailer 
</span></span><span class="line"><span class="cl">&lt;&lt;
</span></span><span class="line"><span class="cl">	/Size 4 
</span></span><span class="line"><span class="cl">	/Root 2 0 R
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">startxref
</span></span><span class="line"><span class="cl">344
</span></span><span class="line"><span class="cl">%%EOF
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/1.png"
	width="628"
	height="812"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/1_hu165dfd04628e02accf29eb023da2e9ff_2434_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/1_hu165dfd04628e02accf29eb023da2e9ff_2434_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="77"
		data-flex-basis="185px"
	
></p>
<p>From &ldquo;<a class="link" href="https://help.callassoftware.com/m/73261/l/798383-how-to-create-a-simple-pdf-file"  target="_blank" rel="noopener"
    >How to create a simple PDF file</a>&rdquo; from Callas Software</p>
<h3 id="file-structure">File structure
</h3><p>From this example, we can see the standard structure of any PDF file:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/2.png"
	width="651"
	height="882"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/2_huf180b2df4dfb8c48c16134280751262a_126641_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/2_huf180b2df4dfb8c48c16134280751262a_126641_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="73"
		data-flex-basis="177px"
	
></p>
<p><strong>Header:</strong> Containing the version of the protocol the file was built with, to instruct the reader program how to read the rest of the structure and render all its elements.</p>
<p><strong>Body:</strong> Here will be all the objects composing the PDF file, pages, images, text, fonts, etc. Even code and automated actions if the file has them.</p>
<p><strong>Cross-reference table:</strong> Here we&rsquo;ll find a list of all the objects of the document for easy access and their respective places inside the file. This is similar to a &rsquo;table of contents&rsquo; but for the PDF reader software to read. If at any given time the reader needs to render a specific object (for instance, if we scroll to a random page on a big document), the reader software will see what page should it render, and look it on this table to locate the respective elements in the body to load them on the screen.</p>
<p><strong>Trailer:</strong> Here we will find the place in the document of the cross-reference table and other useful information, like the number of objects in the cross-reference table (to check that the file is not corrupted for instance), the root object of the document, and encryption information if applicable. PDFs readers by design start reading the documents from the end, where they can find quickly where is the root object, and the cross-reference table to start rendering content.</p>
<h3 id="understanding-pdf-objects">Understanding PDF objects
</h3><p>Given the way PDFs are structured, the most interesting section to deep into is the body, because there we can found everything we can see and interact with (text, pages, images, forms, code, etc.). All of these elements are called objects, and there is a wide range of them according to the specifications, for instance, in the example above, the object</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">4 0 obj
</span></span><span class="line"><span class="cl">&lt;&lt; 
</span></span><span class="line"><span class="cl">	/Type /Page
</span></span><span class="line"><span class="cl">	/Parent 3 0 R
</span></span><span class="line"><span class="cl">	/MediaBox [0 0 612 792] 
</span></span><span class="line"><span class="cl">	/Contents 1 0 R
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">endobj
</span></span></code></pre></td></tr></table>
</div>
</div><p>is a page with the id 4, has a parent element with the id 3, and contains as child the element with id 1 (the red rectangle). Showing the exact way each object is written is outside of the scope of this material, however, there are some kinds of elements that might be used for malicious purposes, and we want to cover them a little more.</p>
<p><strong>/OpenAction:</strong> This object reference a set of actions to be executed when the PDF file is opened, this might be used to launch a website to support the content or for tracking purposes, execute JavaScript code, etc. This might be used to trick users into executing extra actions that can be harmful, or depending on the computer environment, this object can execute malware directly.</p>
<p><strong>/AA:</strong> This object also includes a series of actions that are triggered under varying circumstances, like visualizing a page, hovering the mouse pointer over specific objects, filling form fields, etc. The associated risks are similar to the /OpenAction object, but with many more trigger scenarios.</p>
<p><strong>/JS</strong> or <strong>/Javascript:</strong>  Contains JavaScript code to be executed after an action is triggered, this code might include functions exclusive to PDFs.</p>
<p><strong>/Launch:</strong> Tries to launch an external application on the device after an action is triggered, this might be used, for instance, to open other documents or execute specific commands, which might be harmful.</p>
<p><strong>/EmbeddedFile:</strong> Allows the inclusion of arbitrary files, from documents to executables inside the PDF file. There are antecedents of benign PDF files containing other harmful files embedded, like malware executables or Microsoft Office documents with malicious macros.</p>
<p><strong>/ObjStm:</strong> Contains arbitrary information that will be processed according to the way it is called. The main use for this object is for grouping many objects and compressing them, resulting in a smaller file. However, this might be used as well to compress malicious code as a way to obfuscate it and avoid antivirus detection. Given the many different use cases for this type of object, assuming its presence as malicious will lead us to many false positives.</p>
<p>In more elaborated attacks, a combination of these objects can be used, for instance, a PDF file might trigger an action that opens a file that is embedded in the same file encrypted in a /ObjStm.</p>
<p>Considering all of this, we want to know if a file has any of these object types as a first step to see if a PDF file is malicious, or at least to make sure it is not.</p>
<h2 id="enter-pdfid">Enter pdfid
</h2><p>Given that we know where to start looking for red flags on PDF files we might consider suspicious, we can start using the tool pdfid as the first step to see which object types are contained in our file. Pdfid is a part of a <a class="link" href="https://blog.didierstevens.com/programs/pdf-tools/"  target="_blank" rel="noopener"
    >suite of tools</a> developed by Didier Stevens to streamline some analysis processes on PDF files. These tools are executed using the command line, so they are known as CLI (Command Line Interface) applications. We&rsquo;ll be explaining how to use them using the Remnux Virtual Machine we set up in the previous part of this course.</p>
<p>To use pdfid, we need to open a Terminal application in our virtual machine. When we start our VM this window should be already opened, however, we can always click the Activities menu in the top left corner, and then the Terminal icon in the left panel, as shown in the image,</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/3.png"
	width="149"
	height="443"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/3_hu468e2371f8e9e2fa7e8a3a8dd361a19b_8610_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/3_hu468e2371f8e9e2fa7e8a3a8dd361a19b_8610_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="33"
		data-flex-basis="80px"
	
></p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/4.png"
	width="768"
	height="510"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/4_hu59e80cf33e216aa232b13d00bc49202a_13288_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/4_hu59e80cf33e216aa232b13d00bc49202a_13288_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="361px"
	
></p>
<p>Once in the Terminal window, we can start exploring the use of the pdfid command though its help, we only need to type</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pdfid.py -h
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>-h</code> is for &ldquo;help&rdquo;</p>
<p>Tip: we can always use the Tab key to autocomplete some commands</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/5.png"
	width="768"
	height="667"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/5_hu4d42aece0cad770172455a26052079f5_183635_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/5_hu4d42aece0cad770172455a26052079f5_183635_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="115"
		data-flex-basis="276px"
	
></p>
<p>Here we can see a number of options we can employ when using pdfid, this might look challenging for those new to using the terminal, however, we usually stick to a few of these options, and also with little practice, the process becomes faster and easier.</p>
<p>To analyze our first file, we need to keep present that the command we run in the command line is running “from a folder/directory”, so we need to know where are running the command from, and where is located the file we want to analyze. To give you some context, each time we open the Terminal application in Remnux, we are opening a terminal in the Home directory, the same location that we see when we open the Files application</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/6.png"
	width="134"
	height="300"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/6_hu50420bf634f9d6bb8929e35a651ef7ca_7442_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/6_hu50420bf634f9d6bb8929e35a651ef7ca_7442_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="44"
		data-flex-basis="107px"
	
></p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/7.png"
	width="768"
	height="494"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/7_hu2b6ad170ca127a090abddb07b08043ac_50332_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/7_hu2b6ad170ca127a090abddb07b08043ac_50332_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="155"
		data-flex-basis="373px"
	
></p>
<p>To make things easier for now, we can put our PDFs in this folder, so the terminal command is executed from the same directory as our PDF file.</p>
<p>We can take our example file from above and save it as a pdf file with the help of a text editor on our host computer and drag and drop the file into the Remnux home directory.</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/8.png"
	width="768"
	height="494"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/8_hua41e51cd1573f7fc3554549ccb12dcd5_50813_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/8_hua41e51cd1573f7fc3554549ccb12dcd5_50813_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="155"
		data-flex-basis="373px"
	
></p>
<p>And with this, we can run the following command in our Terminal:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pdfid.py test.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><p>To receive this response:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/9.png"
	width="507"
	height="641"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/9_hu979fc045e548ad2289bb1efffbb6f454_47661_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/9_hu979fc045e548ad2289bb1efffbb6f454_47661_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="79"
		data-flex-basis="189px"
	
></p>
<p>As we can check, all the objects seen by pdfid match with the ones we know from the source of the PDF file, and none of them seems to be in the list of suspicious objects we described above.</p>
<blockquote>
<p>As we stated before, there are techniques malicious actors employ to avoid easy detection of specific kinds of objects, pdfid tries to show even obfuscated objects, however, in some less common cases, there might be hidden objects that will require diving a little deeper to discover.</p>
</blockquote>
<h2 id="enter-pdf-parser-example-1">Enter pdf-parser, example 1
</h2><p>Now, what happens when we find a pdf file with a suspicious object? Imagine we have a file ex005.pdf that gives us an output like this on pdfid:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/10.png"
	width="764"
	height="624"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/10_huc140c40a746c803fabc6a1b28293a4e7_90355_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/10_huc140c40a746c803fabc6a1b28293a4e7_90355_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="122"
		data-flex-basis="293px"
	
></p>
<p>From here, and the guidance above of this resource, we know that there are 3 objects of the types /JS, /Javascript, and /OpenAction that could be interesting to review, especially because they suggest that the file is trying to execute some action when we open the file. Here, we can process it with pdf-parser to get which object type is each object and to see the content of said objects. For our example file, we will execute the following command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pdf-parser.py -a ex005.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><p>We use the argument<code> -a</code> to see file&rsquo;s stats, for a better reference we can always use <code>pdf-parser.py --help</code> to see a list of options on the screen.</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/11.png"
	width="759"
	height="615"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/11_hue195d1f86e4d7dd95f104e0484b531b3_96728_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/11_hue195d1f86e4d7dd95f104e0484b531b3_96728_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="123"
		data-flex-basis="296px"
	
></p>
<p>Here, we can see that indeed we have these three problematic objects, but also some additional information, we can see the id of the objects for each object type. Now we know that the /JS and /Javascript object(s) are living in the object with id 7, and the /OpenAction one is living in the object with id 1. Next, we can see the content of the /OpenAction object to see what the document is trying to do when opening it, for this, we use the command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Pdf-parser.py -o 1 ex005.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here the <code>-o</code> argument is used to give the tool the id of the object which content we want to see on the screen:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/12.png"
	width="763"
	height="627"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/12_huabf27d4235e487d3ad11e6ad2948697e_82296_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/12_huabf27d4235e487d3ad11e6ad2948697e_82296_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="121"
		data-flex-basis="292px"
	
></p>
<p>Here, we can see the line “/OpenAction 7 0 R”, this means that the actual content of the /OpenAction object is living in the object with id 7, and when we open the file, we will call or reference said object. Repeating the process to see the content of the object with id 7 we get:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/13.png"
	width="798"
	height="388"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/13_hu240fb05a8481aa980793c3ec9617edae_85474_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/13_hu240fb05a8481aa980793c3ec9617edae_85474_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="205"
		data-flex-basis="493px"
	
></p>
<p>Where we can see that the document is trying to show an alert or pop-up with the message described in the terminal, if we open the file it will look like this:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/14.png"
	width="767"
	height="408"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/14_hu8f357c68449a325c6b15ba27518c2c79_38435_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/14_hu8f357c68449a325c6b15ba27518c2c79_38435_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="451px"
	
></p>
<h2 id="example-2">Example 2
</h2><p>As we mentioned before, there might be files in which suspicious content is not viewable in plain text, there might be a number of reasons to do this in legitimate cases, like compressing long pieces of information to reduce the size of the file among others, however, malicious files employ these techniques with obfuscation purposes to help avoid detection by antivirus software and other security solutions. For instance, if we repeat the previous workflow to the file ex006.pdf, we will see that the output for the pdfid command is the following:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/15.png"
	width="739"
	height="458"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/15_hu0087100b7c9531a0cd4ddac793445d42_70265_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/15_hu0087100b7c9531a0cd4ddac793445d42_70265_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="161"
		data-flex-basis="387px"
	
></p>
<p>Here we can see in the /JavaScript line “1(1)”, this means that pdfid detected an object of this type, but obfuscated, repeating the same workflow we already know, we review the object with id 8 (where the JavaScript code resides) to see the following:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/16.png"
	width="767"
	height="303"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/16_hu073414def33e4723a0c322b7ab8cdc6b_54720_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/16_hu073414def33e4723a0c322b7ab8cdc6b_54720_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="607px"
	
></p>
<p>Here we can’t see the actual code like in the last example, instead, we see among other things the line “/Filter /FlateDecode”. The /Filter option executes an operation on the final content of a stream to decode it, then /FlateDecode indicates the associated encoding that should be considered when decoding the content, to give a better sense of this, if we open the file with a text editor and search manually for this element we should see something like this:</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/17.png"
	width="736"
	height="292"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/17_hu8afc48eb7fdf077a8e88fe93e3ac15af_55866_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/17_hu8afc48eb7fdf077a8e88fe93e3ac15af_55866_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="604px"
	
></p>
<p>Where the content inside the red square is the actual encoded content, for this case, pdf-parser can try to decode the actual content, for this we use the argument -f, so we end up using the command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Pdf-parser.py -o 8 -f ex006.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/18.png"
	width="753"
	height="295"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/18_hu94d8f6240242d1a777492f31456675ad_67975_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/18_hu94d8f6240242d1a777492f31456675ad_67975_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="612px"
	
></p>
<p>Where we can see the actual content of the object to be rendered by the PDF reader.</p>
<p>Now that we know the basics of how to review PDF files to look for suspicious objects, there are a couple of challenges for you.</p>
<h2 id="example-3">Example 3
</h2><p>Another thing PDF creator software does usually to build new files is to create objects inside streams that are encoded to make the resulting files smaller, this is desirable in general, but also creates a way to further obfuscate malicious code, analyzing the file example3.pdf we see some /ObjStm (Object Streams) that might contain (and they do indeed) other objects that might be interesting.</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/19.png"
	width="768"
	height="442"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/19_hua4806fd27891002334495fe98be505f3_97488_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/19_hua4806fd27891002334495fe98be505f3_97488_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>For this kind of scenarios, it is advisable to use the option -O (as in capital o) of pdf-parser, this option will try to parse any stream containing an object and treat them as regular objects of the file, for instance, using this option like this.</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/20.png"
	width="768"
	height="476"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/20_huee33f7324f90389e4aeec0419c995f5e_109160_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/20_huee33f7324f90389e4aeec0419c995f5e_109160_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="161"
		data-flex-basis="387px"
	
></p>
<p>Reveal that the file has “new” objects and that one of them is an /AA, which is interesting to look for malicious behavior, looking at the respective object we have</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/21.png"
	width="768"
	height="580"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/21_hu655e3eeba03c687d7381f13d399ea49f_97790_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/21_hu655e3eeba03c687d7381f13d399ea49f_97790_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<p>Telling us that the action is tied to a page object, in this case the /O is indicating that the action is triggered when we open the page, and the actual action is stored in the object 37, then</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/22.png"
	width="768"
	height="338"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/22_hua0b51c3a59e9f8d0b047ab79adc0304b_61777_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/22_hua0b51c3a59e9f8d0b047ab79adc0304b_61777_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="227"
		data-flex-basis="545px"
	
></p>
<p>After some research, we can conclude that this object tries to open the properties dialog of the pdf reader like this (nothing especially dangerous – example in a computer configured in Spanish)</p>
<p><img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/23.png"
	width="760"
	height="633"
	srcset="/p/analysis-of-malicious-documents-part-02-pdf-documents/23_hu3cdbaadebec12ef0da1eb0c14de32fed_97467_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-part-02-pdf-documents/23_hu3cdbaadebec12ef0da1eb0c14de32fed_97467_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="120"
		data-flex-basis="288px"
	
></p>
<p>Conclusion: try to use the -O parameter in case there are other objects hiding inside streams</p>
<h2 id="challenges">Challenges
</h2><p><strong>Question:</strong> analyzing the file <a class="link" href="https://drive.google.com/file/d/1BkV1JcWmiuE2_neOCuEiSeY00hM9pK11/view?usp=sharing"  target="_blank" rel="noopener"
    >challenge1.pdf</a> (md5: 3b20821cb817e40e088d9583e8699938), what kind of interesting object is hiding behind a stream?<br>
<details>
    <summary>1. OpenAction</summary>
    <div><strong>Incorrect</strong> &ndash;</div>
</details><br>
<details>
    <summary>2. AA</summary>
    <div><strong>Correct</strong> &ndash;</div>
</details><br>
<details>
    <summary>3. JS</summary>
    <div><strong>Incorrect</strong> &ndash;</div>
</details><br>
<details>
    <summary>3. Javascript</summary>
    <div><strong>Incorrect</strong> &ndash;</div>
</details></p>
<p><strong>Question:</strong> analyzing the file <a class="link" href="https://drive.google.com/file/d/1dSdWgBAM9IP4-BNCFVpRuwukGJkb823F/view?usp=sharing"  target="_blank" rel="noopener"
    >challenge2.pdf</a> (md5: 30373b268d516845751c10dc2b579c97), we can see an action that tries to open an URL, what code the URL includes as a tracking code? (hint: 6 numbers)</p>
<details>
    <summary>I want to see the answer</summary>
    <div><strong>88965</strong></div>
</details>
<h2 id="whats-next">What&rsquo;s next
</h2><p>Now that we know more about PDFs, lets cover in the next part another heavily weaponized kind of files:<a class="link" href="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/" > Office Documents.</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/maldocs-series/">Maldocs-Series</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1.aeb286b75baecbb347674d142d4c8f99_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure"
                        
                        data-hash="md5-rrKGt1uuy7NHZ00ULUyPmQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/11.c0e4f96763858472ba13168bd8c9d580_hu26eed9cc7c1228930433ac93552fb2d8_79691_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 03 – Microsoft Office documents"
                        
                        data-hash="md5-wOT5Z2OFhHK6ExaL2MnVgA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 03 – Microsoft Office documents</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/6.b50246bde9b1d2f15ed77edc7999985e_hu71091bd9fd3cc51e63e3804503417e43_60794_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 01 – Introduction and VMs"
                        
                        data-hash="md5-tQJGvemx0vFe137ceZmYXg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 01 – Introduction and VMs</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/sda-safe-and-documented-for-activism-sda-seguros-y-documentados-para-el-activismo/">
        
        
            <div class="article-image">
                <img src="/p/sda-safe-and-documented-for-activism-sda-seguros-y-documentados-para-el-activismo/sda.20fce1dedb42d131e7757f05163f36ec_hu5a8ad7f9d9c6297e9afdcb725f5bca37_30238_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post SDA: Safe and documented for activism | SDA: Seguros y documentados para el activismo"
                        
                        data-hash="md5-IPzh3ttC0THndX8FFj827A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SDA: Safe and documented for activism | SDA: Seguros y documentados para el activismo</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1.b4a1092850d9c8a78babc75343a6b125_hu36a617cf5e3c297ddbde091be7327273_36258_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  "
                        
                        data-hash="md5-tKEJKFDZyKeLq8dTQ6axJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  </h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Carlos Guerra
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
