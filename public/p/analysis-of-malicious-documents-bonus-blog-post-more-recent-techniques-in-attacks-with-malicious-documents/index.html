<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="This blog post was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes When dealing with suspicious documents at the technical level, we are used to finding resources focusing on Microsoft Office macro-enabled documents (like\u00a0our material on analyzing malicious documents) because they are the most used tools by attackers to trick users into running malicious code on their computers. With this in mind, Microsoft Office\u00a0started to limit\u00a0the execution of macros, making it more difficult to activate them to execute code coming from files downloaded from websites and other potentially untrusted sources.">
<title>Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  </title>

<link rel='canonical' href='http://localhost:1313/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/'>

<link rel="stylesheet" href="/scss/style.min.b28523dc9ab58fa061e5c1d3fc4cf0b596658650e50850a9e38bb46d54fd77ef.css"><meta property='og:title' content="Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  ">
<meta property='og:description' content="This blog post was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes When dealing with suspicious documents at the technical level, we are used to finding resources focusing on Microsoft Office macro-enabled documents (like\u00a0our material on analyzing malicious documents) because they are the most used tools by attackers to trick users into running malicious code on their computers. With this in mind, Microsoft Office\u00a0started to limit\u00a0the execution of macros, making it more difficult to activate them to execute code coming from files downloaded from websites and other potentially untrusted sources.">
<meta property='og:url' content='http://localhost:1313/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/'>
<meta property='og:site_name' content='Carlos Guerra'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='maldocs-series' /><meta property='article:published_time' content='2023-01-05T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-01-05T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1.jpg' />
<meta name="twitter:title" content="Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  ">
<meta name="twitter:description" content="This blog post was posted originally in the Greater Internet Freedom program website, this is a copy for archiving purposes When dealing with suspicious documents at the technical level, we are used to finding resources focusing on Microsoft Office macro-enabled documents (like\u00a0our material on analyzing malicious documents) because they are the most used tools by attackers to trick users into running malicious code on their computers. With this in mind, Microsoft Office\u00a0started to limit\u00a0the execution of macros, making it more difficult to activate them to execute code coming from files downloaded from websites and other potentially untrusted sources."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1.jpg' />
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu99184f921ef7b179b9ae7ead5236baa2_57844_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Carlos Guerra</a></h1>
            <h2 class="site-description">Digital security trainer, auditor, and advisor</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://bsky.app/profile/cguerra.bsky.social'
                        target="_blank"
                        title="Bluesky"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bluesky"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.335 5.144c-1.654 -1.199 -4.335 -2.127 -4.335 .826c0 .59 .35 4.953 .556 5.661c.713 2.463 3.13 2.75 5.444 2.369c-4.045 .665 -4.889 3.208 -2.667 5.41c1.03 1.018 1.913 1.59 2.667 1.59c2 0 3.134 -2.769 3.5 -3.5c.333 -.667 .5 -1.167 .5 -1.5c0 .333 .167 .833 .5 1.5c.366 .731 1.5 3.5 3.5 3.5c.754 0 1.637 -.571 2.667 -1.59c2.222 -2.203 1.378 -4.746 -2.667 -5.41c2.314 .38 4.73 .094 5.444 -2.369c.206 -.708 .556 -5.072 .556 -5.661c0 -2.953 -2.68 -2.025 -4.335 -.826c-2.293 1.662 -4.76 5.048 -5.665 6.856c-.905 -1.808 -3.372 -5.194 -5.665 -6.856z" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/CGurity'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://mastodon.social/@CGurity'
                        target="_blank"
                        title="Mastodon"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z" /><path d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722" /></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#compressed-file-containers-file-extensions-like-zip-and-rar">Compressed file containers (file extensions like .zip and .rar)</a></li>
    <li><a href="#disk-image-container-files-file-extensions-like-iso-and-img">Disk image container files (file extensions like .iso and .img)</a></li>
    <li><a href="#microsoft-onenote-notebooks-file-extension-one">Microsoft OneNote notebooks (file extension .one)</a></li>
    <li><a href="#microsoft-windows-shortcut-file-extension-lnk">Microsoft Windows Shortcut (file extension .lnk)</a></li>
    <li><a href="#all-of-the-above">All of the above</a></li>
    <li><a href="#in-general">In general</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/">
                <img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1_hu36a617cf5e3c297ddbde091be7327273_36258_800x0_resize_q75_box.jpg"
                        srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1_hu36a617cf5e3c297ddbde091be7327273_36258_800x0_resize_q75_box.jpg 800w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1_hu36a617cf5e3c297ddbde091be7327273_36258_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="391" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  " />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/article/" style="background-color: #EDAE49; color: #fff;">
                Article
            </a>
        
            <a href="/categories/author/" style="background-color: #D1495B; color: #fff;">
                Author
            </a>
        
            <a href="/categories/en/" style="background-color: #30638E; color: #fff;">
                EN
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/">Analysis of malicious documents – Bonus blog post – More recent techniques in attacks with malicious documents  </a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 05, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>This blog post was posted originally in the <a class="link" href="https://greaterinternetfreedom.org/blog/more-recent-techniques-in-attacks-with-malicious-documents/"  target="_blank" rel="noopener"
    >Greater Internet Freedom program website</a>, this is a copy for archiving purposes</p>
</blockquote>
<p>When dealing with suspicious documents at the technical level, we are used to finding resources focusing on Microsoft Office macro-enabled documents (like <a class="link" href="/tags/maldocs-series/" >our material on analyzing malicious documents</a>) because they are the most used tools by attackers to trick users into running malicious code on their computers. With this in mind, Microsoft Office <a class="link" href="https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked"  target="_blank" rel="noopener"
    >started to limit</a> the execution of macros, making it more difficult to activate them to execute code coming from files downloaded from websites and other potentially untrusted sources. While this measure certainly helps prevent a significant number of attacks, it also contributes to the scenario of malicious actors exploring other ways to weaponize legitimate technologies to trick users into executing malware.</p>
<p>To emulate the potential of malicious documents, attackers must identify which file formats and workflows are legitimate enough to bypass common security controls, and powerful enough to allow them to infect devices easily through the victims. Based on observed campaigns during the last years, some of the new techniques are:</p>
<h2 id="compressed-file-containers-file-extensions-like-zip-and-rar">Compressed file containers (file extensions like .zip and .rar)
</h2><p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1.jpg"
	width="1024"
	height="501"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1_hu36a617cf5e3c297ddbde091be7327273_36258_480x0_resize_q75_box.jpg 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/1_hu36a617cf5e3c297ddbde091be7327273_36258_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="490px"
	
></p>
<p>Image: An example of an infection chain enabled by a zip file, as reported by <a class="link" href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/return-to-sender-preventing-ransomware-while-working-from-home"  target="_blank" rel="noopener"
    >TrendMicro</a></p>
<p>Zip files are very popular and useful to store or transmit files, especially when the storage limit or internet data cost need to be considered. In terms of security, attackers can store malicious code inside compressed files, send them through email or other channels, and trick us to extract and/or open them. The good news (a bit terrible in terms of privacy though), is that many services <a class="link" href="https://arstechnica.com/information-technology/2023/05/microsoft-is-scanning-the-inside-of-password-protected-zip-files-for-malware/"  target="_blank" rel="noopener"
    >try to see</a> if the compressed file contains potentially harmful elements like executables or macro-enabled files, and warn the users or block the access to the file altogether if actual malicious code is found. In practice, while helpful to mitigate infections, there are some cases where attackers sneak malicious code undetected. Also, they are increasingly chaining different attacks together to try to conceal the actual malicious code, but more about that in a bit.</p>
<h2 id="disk-image-container-files-file-extensions-like-iso-and-img">Disk image container files (file extensions like .iso and .img)
</h2><p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/2.png"
	width="300"
	height="300"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/2_hu55b134b5d2cc629b2e0aa1ada266580b_32316_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/2_hu55b134b5d2cc629b2e0aa1ada266580b_32316_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="240px"
	
></p>
<p>Image: The icon of a .iso file in Microsoft Windows</p>
<p>Like compressed files, disk image containers can store files and can be delivered as just one file. In everyday use, this file format is known as a way of storing disk images in files (&ldquo;CDs&rdquo; with Operating Systems (OS) installers, backups of flash drives or hard drives, images used to restore damaged systems, etc.).</p>
<p>Also, like compressed files, they can be used to store malicious code that we can execute if we are tricked to do so. And for instance, in MacOS, this delivery mechanism is very common to install legitimate software. So, under the right conditions it won&rsquo;t be suspicious to download an image file, open it and double-click some file inside.</p>
<h2 id="microsoft-onenote-notebooks-file-extension-one">Microsoft OneNote notebooks (file extension .one)
</h2><p>Another way to deliver arbitrary files, including malicious code, is the use of OneNote notebooks. They can contain not only regular text and images, but also any kind of file the creator wants to embed for further use, like PDFs and other Microsoft Office files. The way OneNote structures its files is specific to this file format, then, many security solutions might not be configured to analyze the content of OneNote notebooks looking for threats inside embedded files, making this method attractive to deliver malware. However, for this to work, attackers still need their victims to open the OneNote notebook and execute the embedded files.</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/3.png"
	width="780"
	height="367"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/3_hu83321c51f9e0ef143408a81d1df13583_53607_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/3_hu83321c51f9e0ef143408a81d1df13583_53607_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="510px"
	
></p>
<p>Image: <a class="link" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rising-trend-of-onenote-documents-for-malware-delivery/"  target="_blank" rel="noopener"
    >Example</a> of a MS OneNote asking to execute and embedded file</p>
<h2 id="microsoft-windows-shortcut-file-extension-lnk">Microsoft Windows Shortcut (file extension .lnk)
</h2><p>Even when &ldquo;.lnk&rdquo; files sound unknown to many of us, this file format is very common. The associated files are called &ldquo;shortcuts&rdquo; and if you are using a Microsoft Windows computer, there are good chances that you have some of these on your Desktop to open specific applications (you can recognize them by the little folded arrow at the bottom left of the respective icon when using the file explorer).</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/4.png"
	width="157"
	height="151"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/4_huc289696562d771097c95fdbd138328d9_14405_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/4_huc289696562d771097c95fdbd138328d9_14405_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="103"
		data-flex-basis="249px"
	
></p>
<p>In backstage, a shortcut will execute a command in the computer that in most cases will start a program that is living elsewhere in the filesystem, or if it is already started, bring it to the front or open a second instance. Here we can see for our shortcut to GIMP that the actual program lives in a folder inside “Program Files”, even when the shortcut is on our Desktop.</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/5.png"
	width="311"
	height="450"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/5_hu6a56dfe063e3941507385a66c846aba1_39864_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/5_hu6a56dfe063e3941507385a66c846aba1_39864_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="69"
		data-flex-basis="165px"
	
></p>
<p>As one of the features of a shortcut, we can pass extra information to the program that might alter its behavior. For instance, in this shortcut for Microsoft Edge we added the argument “-inprivate”, and now the application will know we want to open a window on InPrivate mode each time we double-click the shortcut.</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/6.png"
	width="314"
	height="454"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/6_huba6994217a2a2dcef0b71350a1be88c7_48181_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/6_huba6994217a2a2dcef0b71350a1be88c7_48181_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="69"
		data-flex-basis="165px"
	
></p>
<p>The issue with this in terms of security, is that someone can craft a shortcut making a program do harmful things, like downloading a file, installing a program, sending information to an unintended party, or all the above. This is happening recently more often where attackers find ways to deploy entire pieces of malicious code (usually called payloads) in victims’ computers using just a shortcut. The fact that anyone can change the name and the icon of shortcuts to anything, makes easier to trick victims to think they are clicking something different to a malware or a shortcut.</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/7.png"
	width="780"
	height="159"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/7_hu60a4adb0eb8ff4331bbb6d665718a644_272557_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/7_hu60a4adb0eb8ff4331bbb6d665718a644_272557_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="490"
		data-flex-basis="1177px"
	
></p>
<p>In this <a class="link" href="https://mp.weixin.qq.com/s?__biz=MzUyMjk4NzExMA%3D%3D&amp;mid=2247498025&amp;idx=1&amp;sn=336c94786f14060ae5c583dc8c77370b&amp;chksm=f9c1ca20ceb64336d678e5265df8264b81625947557b3ab882ec7f362bdf384ffe42e382ae8a&amp;scene=178&amp;cur_album_id=1955835290309230595"  target="_blank" rel="noopener"
    >example</a> we see the content of a malicious shortcut file that opens Microsoft PowerShell and executes a long malicious code that serves as an initial stage of a real malware infection.</p>
<h2 id="all-of-the-above">All of the above
</h2><p>More recently, attackers are conducting infection campaigns that use many tricks together to minimize the chances of being detected before the victim&rsquo;s devices are infected. It is becoming common to read about a campaign that delivers a .iso file containing a macro-enabled document that tries to download obfuscated malware from the internet, or a .zip file containing a .lnk shortcut that copies a piece of malware inside the compressed file to a system folder, among other similar examples. One good thing around these approaches is that they are increasingly looking more strange and hopefully suspicious, but the downside is that it is difficult to communicate or train end-users around those because they might be so different. Therefore it is impossible to explain in detail how these attacks will look like when found, making it more important for people to be clear on how &ldquo;habitual use&rdquo; (or the baseline) looks like, so it is easier to be alert when something feels different.</p>
<p><img src="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/8.png"
	width="624"
	height="336"
	srcset="/p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/8_hu328ba832338d91376537b52606104844_19751_480x0_resize_box_3.png 480w, /p/analysis-of-malicious-documents-bonus-blog-post-more-recent-techniques-in-attacks-with-malicious-documents/8_hu328ba832338d91376537b52606104844_19751_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="445px"
	
></p>
<p>Image: <a class="link" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rising-trend-of-onenote-documents-for-malware-delivery/"  target="_blank" rel="noopener"
    >Example</a> of a chained attack using some of the described techniques</p>
<h2 id="in-general">In general
</h2><p>First, it is a good moment to acknowledge that given the inclusion of new security features in Operating Systems, applications, and services in general, traditional attacks are more difficult to conduct (and hopefully) a bit more uncommon. However, there are still some new and more polished techniques attackers are using to infect targets.</p>
<p>Also, in general, it is important to acknowledge that these attacks are not affecting everyone, so we should be aware of not creating fear in our communities, where depending on the existing levels of anxiety, trauma, and legitimate concerns, a fearmongering message might affect them more negatively than positively. That said, we need to be responsible in the way we transmit the information, introduce these issues, and to whom. For instance, it is more probable that high-profile and high-risk people need to worry about these threats. So in terms of training, these groups or individuals are the most productive to cover these techniques.</p>
<p>One way to put the power in the hands of users is communicating that given all the existing protections, it is less likely that attacks will be successful, and that for those more elaborated attacks, it is still more efficient for attackers to trick us to execute malware ourselves instead of conducting more advanced attacks. So ultimately if we are aware, we will probably know when something is off, and also the good news is that the advice against this use of &ldquo;new&rdquo; file formats mostly remains the same than in the past, some examples:</p>
<ul>
<li>Please think twice before downloading and opening files that you usually don&rsquo;t receive. Are there ways to check with the sender over a different channel?</li>
<li>Keep an eye on file extensions. If this is a document, then why is it inside a .iso or .zip file? Is there a legitimate reason for this?
<ul>
<li>Bonus: We can also activate for our Operating System the visualization of file extensions, so it is easier to see if one file is disguised as a different file format.</li>
</ul>
</li>
<li>Be aware in case an attachment we opened is asking us to give admin permissions and why.</li>
<li>Keep Operating Systems and applications up to date.</li>
<li>It is also important to know the end-of-life date of our devices, operating systems, and other technical solutions; this date will tell us when our technology is expected to stop receiving updates, including security ones. A good place to start looking at this is <a class="link" href="https://endoflife.date/pixel"  target="_blank" rel="noopener"
    >endoflife.date</a> (the link points to an example for Google Pixel).</li>
<li>For very high-profile/complex threat models: Prepare a physical or virtual environment to open suspicious files, like Virtualbox, using Qubes OS, or even opening documents inside Gmail or Outlook without downloading the files, among other things.</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/maldocs-series/">Maldocs-Series</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-04-defensive-measures-next-steps-and-closure/1.aeb286b75baecbb347674d142d4c8f99_hu47a86cfd803a9df7c9cd05ac2ffab0be_30367_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure"
                        
                        data-hash="md5-rrKGt1uuy7NHZ00ULUyPmQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 04 – Defensive measures, next steps, and closure</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-03-microsoft-office-documents/11.c0e4f96763858472ba13168bd8c9d580_hu26eed9cc7c1228930433ac93552fb2d8_79691_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 03 – Microsoft Office documents"
                        
                        data-hash="md5-wOT5Z2OFhHK6ExaL2MnVgA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 03 – Microsoft Office documents</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-02-pdf-documents/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-02-pdf-documents/13.9fc6d1d131919eee16849d6694281c26_hu240fb05a8481aa980793c3ec9617edae_85474_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 02 – PDF documents"
                        
                        data-hash="md5-n8bR0TGRnu4WhJ1mlCgcJg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 02 – PDF documents</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/">
        
        
            <div class="article-image">
                <img src="/p/analysis-of-malicious-documents-part-01-introduction-and-vms/6.b50246bde9b1d2f15ed77edc7999985e_hu71091bd9fd3cc51e63e3804503417e43_60794_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Analysis of malicious documents – Part 01 – Introduction and VMs"
                        
                        data-hash="md5-tQJGvemx0vFe137ceZmYXg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Analysis of malicious documents – Part 01 – Introduction and VMs</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/fade-project-fade-antenna-detection-project/">
        
        
            <div class="article-image">
                <img src="/p/fade-project-fade-antenna-detection-project/fade.f432e0ad76db2eb22ed50309588b2596_hud64966d7dcc91f993f6a1e03dd8e8361_153165_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post FADe Project: Fade Antenna Detection Project"
                        
                        data-hash="md5-9DLgrXbbLrIu1QMJWIsllg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">FADe Project: Fade Antenna Detection Project</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Carlos Guerra
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
